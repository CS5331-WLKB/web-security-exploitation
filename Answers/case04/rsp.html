
<html>
	<script>
	var tagsToReplace = {
	    '&': '&amp;',
	    '<': '&lt;',
	    '>': '&gt;'
	};
	
	function replaceTag(tag) {
	    return tagsToReplace[tag] || tag;
	}
	
	function safe_tags_replace(str) {
	    return str.replace(/[&<>]/g, replaceTag);
	}
	
	function sanitise(){
		var input = document.getElementById('title').value;
		input = safe_tags_replace(input); 
		document.getElementById('title').value = input;
		
		var input2 = document.getElementById('content').value;
		input2 = safe_tags_replace(input2); 
		document.getElementById('content').value = input2;
		
		document.getElementById("form_valid").submit();
	}
	
	</script>
	
	<body>
		<h1>Case 04</h1>
		<font color=red>[Note] To reset this page, visit "[url]?delete=true" </font><br/><br/>

		<h3>Guest Book</h3>
		1. hello world<br/>welcome to my guestbook
<br/><br/><br/>

2.  ds<br/>%3B%3Cscript%3Ealert%28document.cookie%29%3C%252Fscript%3E
<br/><br/><br/>

3. steal<br/><script>alert(document.cookie)</script>
<br/><br/><br/>

4. steal<br/>mmp<script>alert(document.cookie)</script>
<br/><br/><br/>

5. steal<br/>mmp<script>alert('aha')</script>
<br/><br/><br/>

		
	
		<br/><br/><br/>
				
		<form action="/Assignment2/case04.php" method="post" id="form_valid" > 
			Enter your comments: 
			<table>
				<tr>
					<td width="20%">Title: </td>
					<td><input type="type" id="title" name="title" maxlength="10"/><br/><br/></td>
				</tr>
				
				<tr>
					<td>Message: </td>
					<td><textarea name="content" id="content" cols="50" rows="10"></textarea><br/><br/></td>
				</tr>
			</table>

			<input type="submit" onClick="sanitise()"/>
		</form>
		
		<br/>		
	</body>
</html>